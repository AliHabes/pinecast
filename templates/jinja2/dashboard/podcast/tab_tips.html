{% set owner_us = get_user_settings(podcast.owner) %}
{% if not owner_us.has_connected_account() %}
  <div class="card-block card">
    <strong>{{ _('Tip Jar') }}</strong>
    <p>
      {% trans %}Make money through your podcast with your Pinecast Tip Jar.{% endtrans %}
    </p>
    {% if user == podcast.owner %}
      <p>
        {% trans us_url=(url('user_settings') + '#bank-account-details') %}
          Before you can start accepting tips, you must <a href="{{ us_url }}">add bank account details</a> to your account.
        {% endtrans %}
      </p>
    {% else %}
      <p>
        {% trans %}
          The owner of this podcast needs to add their bank account details to their account in order to start accepting tips on this podcast. An account is required in order for us to process payments.
        {% endtrans %}
      </p>
    {% endif %}
  </div>
{% else %}
  <div class="card-block card">
    <div class="stats-panel">
      <div class="segment">
        <span>{{ _('All Time') }}</span>
        <em>
          {{ '$%0.2f' % (podcast.total_tips / 100) }}
        </em>
      </div>
      <div class="segment">
        <span>{{ _('Last Payout') }}</span>
        {% set last_payout_date = podcast.last_payout_date() %}
        <em title="{{ last_payout_date }}">
          {{ last_payout_date|pretty_date if last_payout_date else _('Never') }}
        </em>
      </div>
      {% set average_tip_this_month = podcast.average_tip_value_this_month() %}
      {% if average_tip_this_month %}
        <div class="segment">
          <span>{{ _('Month Average') }}</span>
          <em>
            {{ '$%0.2f' % (average_tip_this_month / 100) }}
          </em>
        </div>
      {% endif %}

      {% if owner_us.plan == PLANS['PLAN_DEMO'] %}
        <div class="segment">
          <span>{{ _('Fees Paid') }}</span>
          <em>
            {{ '$%0.2f' % (podcast.tip_fees_paid() / 100) }}
          </em>
        </div>
      {% endif %}
    </div>
  </div>
  {% set next_payout_date = podcast.next_payout_date() %}
  {% if next_payout_date %}
    <div class="card-block card">
      <strong>{{ _('Next Payout') }}</strong>
      <p>
        {# TODO: this is not how to properly localize dates #}
        {% trans payout_date=next_payout_date, payout_friendly=next_payout_date|pretty_date %}
          Your podcast's tips will be deposited in your account {{ payout_friendly }} on {{ payout_date }}.
        {% endtrans %}
      </p>
    </div>
  {% else %}
    <div class="card-block card">
      <strong>{{ _('Next Payout') }}</strong>
      <p>
        {% trans %}
          There are no pending tips for your podcast. Earn some tips and we'll schedule a payout date!
        {% endtrans %}
      </p>
    </div>
  {% endif %}
  <div class="card-block card">
    <strong>{{ _('Tip Jar URL') }}</strong>
      <p>
        {% trans %}
          Share this address with your listeners to receive contributions to your podcast.
        {% endtrans %}
      </p>
    <input type="url"
      title="{{ _('Tip Jar') }}"
      readonly
      value="https://pinecast.com{{ url('tip_jar', podcast_slug=podcast.slug) }}">
  </div>
{% endif %}
